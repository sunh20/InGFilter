
<!DOCTYPE html>
<html>
   <head>
      <style>
      #media li{
      display: inline;
      list-style-type: none;
      padding-right: 20px;
      vertical-align: top;
      }
      </style>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
   </head>
<body>

   <h1>InStats</h1>   
   <p>~*~Check your Instagram stats~*~</p>

   <p><a href = 
      "https://www.instagram.com/oauth/authorize/?client_id=cc4d3923bd05428597ec55a70b5680fa&redirect_uri=http://samsamsun.me&response_type=token">
      Authenticate</a></p>
   
   <script>
   // gets a users access token, stores to access_token      
   var access_token = window.location.href.split("=")[1];
   if (access_token != null) {
      console.log("Authentication complete");  
      console.log(access_token); // for debugging
   }
      
   // gets users data (username, bio, follower counts, media, id, full name, profile pic)
   function getUserData() {
      $.ajax ({  
         type: "GET",
         dataType: "jsonp",
         cache: false,
         url: "https://api.instagram.com/v1/users/self/?access_token=" + access_token,
         success: function(data) {
            console.log("sucessfully retrived user data");
            $('.name').text(data.data.username);
            $('.bio').text(data.data.bio);
            $('.realName').text(data.data.full_name);
            $(".pic").append("<li><img src='" + data.data.profile_picture + "'></img></a></li>");
         }
      });
      return null;
   }

   // get recent media only want this to run once
   var hasRun = false;
   function getRecentMedia() {
      if (!hasRun) {
         $.ajax ({  
            type: "GET",
            dataType: "jsonp",
            cache: false,
            url: "https://api.instagram.com/v1/users/self/media/recent/?access_token=" + access_token,
            success: function(data) {
               console.log("sucessfully retrived media");
               for (var i = 0; i < 10; i++) {
                  if (data.data[i].type === "video") {
                     $(".media").append("<li><a target='_blank' href='" + data.data[i].link + "'><video controls loop autoplay src='" + data.data[i].videos.low_resolution.url + "'></video></a></li>");
                  } else { 
                     $(".media").append("<li><a target='_blank' href='" + data.data[i].link + "'><img src='" + data.data[i].images.low_resolution.url + "'></img></a></li>");
                  }
               }
            }
         });
      }
      hasRun = true;
      return null;
   }

   </script>

   <p>Welcome <b class="realName"></b>!</p>
   <p>Username: <b class="name"></b></p>
   <p>Bio: <b class="bio"></b></p>
   <p class="pic"></p>

   <button type="button" onclick="getUserData(); this.style.display = 'none'">Load information</button>

   <button type="button" onclick="getRecentMedia()">Last 3 Photos</button>
   <div class="media"></div>
   
   <p>Top 3 photos</p>
   <p>Top 3 followers</p>
   <p>Follow each other</p>
  

</body>
</html>
